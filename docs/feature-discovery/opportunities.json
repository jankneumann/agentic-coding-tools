{
  "generated_at": "2026-02-21T10:00:00Z",
  "focus_area": "parallel agent port isolation",
  "history_adjustment_applied": true,
  "weights": {
    "impact": 0.4,
    "strategic_fit": 0.25,
    "effort": 0.2,
    "risk": 0.15
  },
  "mappings": {
    "priority": { "low": 1, "med": 2, "high": 3 },
    "effort": { "S": 1, "M": 2, "L": 3 }
  },
  "items": [
    {
      "id": "add-port-allocator-service",
      "title": "Add standalone port allocation service to agent-coordinator",
      "problem_statement": "When multiple coding agents run parallel /validate-feature flows, each worktree spins up its own docker-compose stack. All stacks compete for the same default ports (3000, 4000, 54322, 8081), causing bind failures. Manual port remapping is error-prone and doesn't scale. The agent-coordinator already has the right infrastructure (config system, service pattern, MCP+HTTP interfaces) but lacks a port registry that agents can query to get conflict-free port assignments.",
      "impact": "high",
      "strategic_fit": "high",
      "effort": "M",
      "risk": "low",
      "score": 2.8,
      "bucket": "quick-win",
      "suggested_change_prefix": "add-",
      "change_id_hint": "add-port-allocator",
      "blocked_by": [],
      "recommended_action": "/plan-feature now",
      "why_now": "This is a daily pain point when running parallel agents. The agent-coordinator config and service patterns already exist, making it a natural extension. Critically, this feature should work standalone — no Supabase required — making it immediately useful even in lightweight setups."
    },
    {
      "id": "fix-validate-feature-hardcoded-ports",
      "title": "Fix hardcoded ports in validate-feature skill and integration tests",
      "problem_statement": "validate-feature/SKILL.md has hardcoded localhost:3000 in health checks (line 181) and spec compliance examples (line 345). Integration test conftest.py hardcodes POSTGREST_URL to localhost:3000. docker-compose invocations don't explicitly forward port env vars. These bugs block any port remapping strategy.",
      "impact": "med",
      "strategic_fit": "high",
      "effort": "S",
      "risk": "low",
      "score": 2.6,
      "bucket": "quick-win",
      "suggested_change_prefix": "fix-",
      "change_id_hint": "fix-validate-hardcoded-ports",
      "blocked_by": [],
      "recommended_action": "/plan-feature now (can parallel with port-allocator)",
      "why_now": "These are bugs, not features. They silently break any attempt to run validation on non-default ports. Quick fix, high leverage."
    },
    {
      "id": "add-env-template-generator",
      "title": "Add env template generator for isolated docker-compose stacks",
      "problem_statement": "Even with a port allocator, agents need a way to generate a complete .env file with all port variables set consistently for a given worktree/session. Currently this is manual. A template generator that takes a session-id or worktree-id and produces a coherent .env (ports, project names, network names) would close the gap.",
      "impact": "med",
      "strategic_fit": "high",
      "effort": "S",
      "risk": "low",
      "score": 2.6,
      "bucket": "quick-win",
      "suggested_change_prefix": "add-",
      "change_id_hint": "add-env-template-generator",
      "blocked_by": ["add-port-allocator-service"],
      "recommended_action": "plan as part of port-allocator proposal",
      "why_now": "Natural companion to port allocator. Without it, agents still need to manually wire port assignments into env files."
    },
    {
      "id": "add-docker-compose-project-isolation",
      "title": "Add COMPOSE_PROJECT_NAME isolation for parallel stacks",
      "problem_statement": "Docker Compose uses the directory name as the default project name. Two worktrees running docker-compose in agent-coordinator/ will collide on container names, networks, and volumes even if ports differ. Setting COMPOSE_PROJECT_NAME per worktree/session is required for true parallel isolation.",
      "impact": "high",
      "strategic_fit": "med",
      "effort": "S",
      "risk": "low",
      "score": 2.55,
      "bucket": "quick-win",
      "suggested_change_prefix": "add-",
      "change_id_hint": "add-compose-project-isolation",
      "blocked_by": [],
      "recommended_action": "include in port-allocator proposal",
      "why_now": "Port remapping alone is insufficient — container name and network collisions are equally blocking for parallel stacks."
    },
    {
      "id": "update-worktree-skill-port-integration",
      "title": "Integrate port allocator into openspec-beads-worktree skill",
      "problem_statement": "The openspec-beads-worktree skill handles git worktree isolation but is completely unaware of port/resource isolation. Parallel task execution (its core use case) will fail when tasks spin up services.",
      "impact": "med",
      "strategic_fit": "med",
      "effort": "M",
      "risk": "med",
      "score": 2.0,
      "bucket": "big-bet",
      "suggested_change_prefix": "update-",
      "change_id_hint": "update-worktree-port-integration",
      "blocked_by": ["add-port-allocator-service"],
      "recommended_action": "defer until port allocator exists",
      "why_now": "Depends on port allocator being available. Once it is, this becomes a natural enhancement to the worktree skill."
    },
    {
      "id": "add-security-review-skill-core",
      "title": "Build a reusable /security-review skill core",
      "problem_statement": "Security checks are scattered across ad-hoc commands and project-specific flows. There is no dedicated, reusable review skill for the approval gate workflow.",
      "impact": "high",
      "strategic_fit": "high",
      "effort": "M",
      "risk": "low",
      "score": 2.8,
      "bucket": "quick-win",
      "suggested_change_prefix": "add-",
      "change_id_hint": "add-security-review-skill",
      "blocked_by": [],
      "recommended_action": "already implemented (change: add-security-review-skill, status: Complete)",
      "why_now": "Already done — demoted from active recommendation."
    }
  ],
  "top_recommendation": "add-port-allocator-service"
}
