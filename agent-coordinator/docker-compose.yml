# Local PostgreSQL development environment (ParadeDB: Postgres + pg_search + pgvector)
# Run: docker compose up -d

services:
  # PostgreSQL database with ParadeDB extensions
  postgres:
    image: paradedb/paradedb:latest
    container_name: agent-coordinator-db
    ports:
      - "${AGENT_COORDINATOR_DB_PORT:-54322}:5432"
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: postgres
    volumes:
      - postgres-data:/var/lib/postgresql/data
      - ./supabase/migrations:/docker-entrypoint-initdb.d/
    healthcheck:
      test: pg_isready -U postgres
      interval: 5s
      timeout: 5s
      retries: 10

volumes:
  postgres-data:

# Development notes:
# - Single-service setup using ParadeDB (Postgres + pg_search + pgvector)
# - Host port is configurable to avoid collisions:
#   - AGENT_COORDINATOR_DB_PORT (default: 54322)
# - PostgreSQL is available at localhost:${AGENT_COORDINATOR_DB_PORT:-54322}
# - Migrations in ./supabase/migrations/ are applied automatically on first start
#
# For local development, set:
#   DB_BACKEND=postgres
#   POSTGRES_DSN=postgresql://postgres:postgres@localhost:54322/postgres
