# Database Backend
# "postgres" (default, direct asyncpg) or "supabase" (legacy PostgREST)
DB_BACKEND=postgres

# ---------------------------------------------------------------------------
# Local Development (ParadeDB)
# ---------------------------------------------------------------------------
# ParadeDB via docker-compose (see docker-compose.yml)
POSTGRES_DSN=postgresql://postgres:postgres@localhost:54322/postgres
# POSTGRES_POOL_MIN=2
# POSTGRES_POOL_MAX=10

# ---------------------------------------------------------------------------
# Cloud Deployment (Railway)
# ---------------------------------------------------------------------------
# Railway internal networking â€” set these in the Railway service variables
# POSTGRES_DSN=postgresql://...@paradedb.railway.internal:5432/coordinator
#
# API key authentication for cloud agents
# COORDINATION_API_KEYS=<generated-key>
# COORDINATION_API_KEY_IDENTITIES={"key1": {"agent_id": "cloud-agent-1", "agent_type": "cloud_agent"}}
#
# SSRF allowlist for Railway hostnames (comma-separated, no scheme/port)
# COORDINATION_ALLOWED_HOSTS=your-app.railway.app,your-app-production.up.railway.app

# ---------------------------------------------------------------------------
# Agent Identity
# ---------------------------------------------------------------------------
# These identify this agent instance in the coordination system
AGENT_ID=claude-code-1
AGENT_TYPE=claude_code

# Optional: Session tracking
SESSION_ID=

# Lock Configuration
# Default lock TTL in minutes (default: 120 = 2 hours)
LOCK_TTL_MINUTES=120

# Guardrails Configuration
# Cache TTL for guardrail patterns in seconds (default: 300)
GUARDRAILS_CACHE_TTL=300
# Enable code fallback patterns when DB is unavailable (default: true)
GUARDRAILS_CODE_FALLBACK=true

# Agent Profiles Configuration
# Default trust level for unknown agents (default: 1)
PROFILES_DEFAULT_TRUST_LEVEL=1
# Enforce resource limits from profiles (default: true)
PROFILES_ENFORCE_RESOURCE_LIMITS=true

# Audit Configuration
# Retention period for audit entries in days (default: 90)
AUDIT_RETENTION_DAYS=90
# Use async (fire-and-forget) logging (default: true)
AUDIT_ASYNC_LOGGING=true

# Network Policies Configuration
# Default policy when no matching rule: "deny" or "allow" (default: deny)
NETWORK_DEFAULT_POLICY=deny

# Policy Engine Configuration
# "native" (profiles + network policies) or "cedar" (cedarpy)
POLICY_ENGINE=native
# Cache TTL for Cedar policies in seconds (default: 300)
POLICY_CACHE_TTL=300
# Fall back to file-based policies when DB unavailable (default: true)
POLICY_CODE_FALLBACK=true
# Path to Cedar schema file (optional, auto-detected from cedar/ dir)
# CEDAR_SCHEMA_PATH=cedar/schema.cedarschema

# GitHub Coordination (optional)
# GITHUB_TOKEN=ghp_your_token
# GITHUB_REPO=owner/repo

# ---------------------------------------------------------------------------
# Legacy / Alternative: Supabase (PostgREST)
# ---------------------------------------------------------------------------
# To use Supabase instead of direct Postgres, set DB_BACKEND=supabase above
# and configure the values below from your Supabase project dashboard.
# SUPABASE_URL=https://your-project.supabase.co
# SUPABASE_SERVICE_KEY=your-service-role-key
